!function(e){e.fn.visualLightbox=function(t){var i,n,o=null,a=["select","object","embed"],r=null,l=[],s=null,d=null,c=0,h=50;if(document.getElementsByTagName){if((t=e.extend({animate:!0,autoPlay:!0,borderSize:39,containerID:document,enableSlideshow:!0,googleAnalytics:!1,descSliding:!0,imageDataLocation:"south",shadowLocation:"",closeLocation:"",pauseLocation:"",initImage:"",loop:!0,overlayDuration:.2,overlayOpacity:.7,prefix:"",classNames:"vlightbox",resizeSpeed:7,showGroupName:!1,slideTime:4,strings:{closeLink:"",loadingMsg:"loading",nextLink:"",prevLink:"",startSlideshow:"",stopSlideshow:"",numDisplayPrefix:"",numDisplaySeparator:"/"},openByHover:!1,enableRightClick:!1,featBrowser:!0,breathingSize:10,startZoom:!1,floating:!0},t)).animate){var m=Math.max(t.overlayDuration,0);t.resizeSpeed=Math.max(Math.min(t.resizeSpeed,10),1);var u=.15*(11-t.resizeSpeed)}else m=0,u=0;var g=t.enableSlideshow;t.overlayOpacity=Math.max(Math.min(t.overlayOpacity,1),0);var p=t.autoPlay,f=e(t.containerID),v=t.classNames;e("."+v.replace(/\,/g,",."),f).each((function(){V(this)&&(t.openByHover?e(this).hover((function(){J.start(this)}),(function(){J.stop(this)})):e(this).click((function(e){return e.preventDefault(),K(this),!1})))}));var b=f.length&&f.get(0)!=document?f.get(0):document.getElementsByTagName("body").item(0);if(b.childNodes.length&&(e(b.childNodes[0]).before(e("<div></div>")),b=b.childNodes[0]),!document.getElementById(Ce("overlay"))){var w=document.createElement("div");w.setAttribute("id",Ce("overlay")),w.style.display="none",b.appendChild(w);var y=document.createElement("div");y.setAttribute("id",Ce("lightbox")),y.style.display="none",b.appendChild(y);var x=document.createElement("div");x.setAttribute("id",Ce("imageDataContainer")),x.className=Ce("clearfix");var C=document.createElement("table");C.setAttribute("id",Ce("outerImageContainer")),C.cellSpacing=0,y.appendChild(C);var k=C.insertRow(-1);k.insertCell(-1).className="tl",k.insertCell(-1).className="tc";var L=k.insertCell(-1);L.className="tr";var I=C.insertRow(-1);I.insertCell(-1).className="ml";var S=I.insertCell(-1);S.setAttribute("id",Ce("lightboxFrameBody")),I.insertCell(-1).className="mr";var E=C.insertRow(-1);E.insertCell(-1).className="bl";var A=E.insertCell(-1);A.className="bc",E.insertCell(-1).className="br","north"==t.imageDataLocation&&S.appendChild(x);var D=document.createElement("div");D.setAttribute("id",Ce("imageData")),x.appendChild(D);var N=document.createElement("div");N.setAttribute("id",Ce("imageDetails")),D.appendChild(N);var T=document.createElement("div");T.setAttribute("id",Ce("caption")),N.appendChild(T),T.style.display="none";var M=document.createElement("span");M.setAttribute("id",Ce("numberDisplay")),N.appendChild(M);var H=document.createElement("span");H.setAttribute("id",Ce("detailsNav")),N.appendChild(H);var z=document.createElement("div");z.setAttribute("id",Ce("imageContainerMain")),S.appendChild(z);var B=document.createElement("div");B.setAttribute("id",Ce("imageContainer")),z.appendChild(B);var W=document.createElement("img");if(W.setAttribute("id",Ce("lightboxImage")),B.appendChild(W),!t.enableRightClick){var O=document.createElement("div");O.setAttribute("id",Ce("hoverNav")),O.style.background="white",O.style.opacity=0,O.style.filter="alpha(opacity=0)",B.appendChild(O)}var Z=document.createElement("a");Z.setAttribute("id",Ce("prevLinkImg")),Z.setAttribute("href","javascript:void(0);"),z.appendChild(Z);var j=document.createElement("a");j.setAttribute("id",Ce("nextLinkImg")),j.setAttribute("href","javascript:void(0);"),z.appendChild(j);var R=document.createElement("div");R.setAttribute("id",Ce("loading")),B.appendChild(R);var q=document.createElement("a");q.setAttribute("id",Ce("loadingLink")),q.setAttribute("href","javascript:void(0);"),q.innerHTML=t.strings.loadingMsg,R.appendChild(q),"north"!=t.imageDataLocation&&S.appendChild(x);var P=document.createElement("div");P.setAttribute("id",Ce("shadow")),(t.shadowLocation?document.getElementById(Ce(t.shadowLocation)):A).appendChild(P);var X=document.createElement("a");X.setAttribute("id",Ce("prevLinkDetails")),X.setAttribute("href","javascript:void(0);"),X.innerHTML=t.strings.prevLink,H.appendChild(X);var G=document.createElement("a");G.setAttribute("id",Ce("slideShowControl")),G.setAttribute("href","javascript:void(0);"),document.getElementById(Ce(t.pauseLocation||"detailsNav")).appendChild(G);var Y=document.createElement("a");if(Y.setAttribute("id",Ce("closeLink")),Y.setAttribute("href","javascript:void(0);"),Y.innerHTML=t.strings.closeLink,"nav"==t.closeLocation)H.appendChild(Y);else{var F=document.createElement("div");F.setAttribute("id",Ce("close")),"top"==t.closeLocation?L.appendChild(F):D.appendChild(F),F.appendChild(Y)}var Q=document.createElement("a");Q.setAttribute("id",Ce("nextLinkDetails")),Q.setAttribute("href","javascript:void(0);"),Q.innerHTML=t.strings.nextLink,H.appendChild(Q)}var J=new function(e,t,i,n){var o,a,r;this.start=function(n){r&&clearTimeout(r),r=0,n&&n!=o&&(o&&(a?clearTimeout(a):i(o),a=0),o=n,a=setTimeout((function(){a=0,e(n)}),t))},this.stop=function(e){!o||e&&o!=e||(a&&clearTimeout(a),a=0,r||(r=setTimeout((function(){r=0,i(e||o),o=0}),n)))}}((function(e){K(e)}),400,(function(){pe()}),300);""!=t.initImage&&K("#"+t.initImage);var K=this.start=function(i){!function(){for(var t=a,i=0;i<t.length;i++)e(t[i]).css({visibility:"hidden"})}(),i=e(i),c=i.get(0),ke("overlay").css({height:xe()[1]+"px",top:0,left:ye().x+"px"}),t.descSliding&&ke("imageDataContainer").hide(),ke("lightboxImage").hide().attr({src:""}),t.startZoom?(ke("imageContainer").css({width:i.width()+"px",height:i.height()+"px"}),document.all||ke("outerImageContainer").css({opacity:.1}),ke("lightbox").css({left:i.offset().left-t.borderSize+"px",top:i.offset().top-t.borderSize+"px",width:i.width()+2*t.borderSize+"px",height:"auto"})):(ke("overlay").css({opacity:0}).show().fadeTo(1e3*m,t.overlayOpacity),ke("lightbox").css({left:0,width:"100%"})),U(Ce("overlay"),"click",pe),t.openByHover?ke("lightbox").unbind().hover((function(){J.start()}),(function(){J.stop()})):U(Ce("lightbox"),"click",pe),U(Ce("prevLinkDetails"),"click",me),U(Ce("slideShowControl"),"click",se),U(Ce("closeLink"),"click",pe),U(Ce("nextLinkDetails"),"click",ce),t.enableRightClick||(U(Ce("hoverNav"),"mousemove",fe),U(Ce("hoverNav"),"mouseout",ve)),U(Ce("prevLinkImg"),"click",me),U(Ce("nextLinkImg"),"click",ce),U(Ce("loadingLink"),"click",pe),ke("lightbox").show(),l=[],r=null,d=0,e("."+(i.attr("className")||i.get(0).className),f).each((function(){V(this)&&(l.push({link:V(this),title:_(this)}),this==i.get(0)&&(d=l.length-1))})),l.length>1&&(r=i.attr("className")),t.featBrowser&&e(window).resize(be),t.floating&&e(window).scroll(be),e(window).resize(we),e(window).scroll(we),ee(d)};return this}function U(t,i,n){e("#"+t).unbind()[i](n)}function V(t){return"a"!=t.tagName.toLowerCase()&&(t=e("A:first",t)),e(t).attr("href")}function _(t){return/^a$/i.test(t.tagName)?e(t).attr("title")||t.title:e(">div:first",t).html()}function ee(e){o=e,ue(),de(),function(){clearTimeout(n);var e=ke("loading");e.show(),e.css({visibility:"hidden"}),n=setTimeout((function(){ke("loading").css({visibility:"visible"})}),300)}(),t.startZoom||ke("lightboxImage").hide(),ke("prevLinkImg").hide(),ke("nextLinkImg").hide(),t.descSliding&&ke("imageDataContainer").hide(),(i=new Image).onload=function(){l[o].link=i.src,l[o].width=i.width,l[o].height=i.height,te(!1)},t.startZoom&&!ke("lightboxImage").attr("src")&&(l[o].width=320,l[o].height=240,te(!1,!0)),i.src=l[o].link,t.googleAnalytics&&urchinTracker(l[o].link)}function te(n,a){var r,s,d,g,p=l[o].width,f=l[o].height,v=function(){var e,t;self.innerHeight?(e=self.innerWidth,t=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):document.body&&(e=document.body.clientWidth,t=document.body.clientHeight);return{winWidth:e,winHeight:t}}(),b=p/f;if(t.featBrowser){var w=v.winWidth/v.winHeight;if((p+2*t.borderSize+2*t.breathingSize)/(f+2*t.borderSize+2*t.breathingSize+h)>w)var y=v.winWidth-2*t.borderSize-2*t.breathingSize,x=Math.round(y/b);else x=v.winHeight-2*t.borderSize-2*t.breathingSize-h,y=Math.round(x*b);(p>y||f>x)&&(p=y,f=x)}d=p+2*t.borderSize,g=f+h+2*t.borderSize;var C=ye();t.openByHover?(s=Math.min(Math.max(e(c).offset().left+e(c).width()/2-d/2,C.x),C.x+v.winWidth-d),r=Math.min(Math.max(e(c).offset().top+e(c).height()/2-g/2,C.y),C.y+v.winHeight-g)):(r=C.y+(v.winHeight-g)/2,s=C.x),(g=Math.max(g,parseInt(ke("lightbox").height())))>v.winHeight&&(r=Math.max(Math.min(ke("lightbox").offset().top,C.y),C.y+v.winHeight-g));var k=t.openByHover?d+"px":/mobile.+safari/i.test(navigator.userAgent)?v.winWidth+"px":"100%",L=ke("imageContainer");if(1==n)L.css({height:f+"px",width:p+"px"}),t.floating?ie(ke("lightbox"),s,r,k):ke("lightbox").css({top:r+"px",left:s+"px"});else{var I,S=ke("lightboxImage");L.stop(!0,!1),S.stop(!0,!1),t.startZoom&&S.attr("src")?(I=S).attr({id:Ce("lightboxImage2")}):S.remove(),a||((S=e(i)).hide(),S.attr({id:Ce("lightboxImage")}),L.append(S));var E=b/(L.width()/L.height());if(!a){if(t.startZoom){I&&ke("lightboxImage2").stop(!0,!0);var A=I?120:100;I&&I.css({width:1>E?"auto":I.width()/I.parent().width()*100+"%",height:1>E?I.height()/I.parent().height()*100+"%":"auto",left:0,top:0}),S.css({opacity:0,display:"block",position:"absolute",width:1>E?A+"%":"auto",height:1>E?"auto":A+"%",left:(100-A*(1>E?1:E))/2+"%",top:(100-A*(1>E?1/E:1))/2+"%"})}t.startZoom&&ne()}t.featBrowser||window.scrollTo(ye().x,r),function(i,n,a,r,s,d,c){var h=ke("imageContainer"),g=ke("lightboxImage"),p=ke("lightbox");if(!c)var f=ke("lightboxImage2");t.startZoom&&(g.fadeTo(1e3*u,1),document.all||ke("outerImageContainer").fadeTo(1e3*u,1));ie(p,i,n,s),t.startZoom&&!c&&(f.animate(e.extend({opacity:0},d<1?{height:"120%",top:"-10%",left:(100-120/d)/2+"%"}:{width:"120%",left:"-10%",top:(100-120*d)/2+"%"}),{queue:!1,duration:1e3*u,complete:function(){e(this).remove()}}),g.animate(e.extend({left:0,top:0},d<1?{width:"100%"}:{height:"100%"}),{queue:!1,duration:1e3*u}));h.animate({width:a+"px",height:r+"px"},{queue:!1,duration:1e3*u,complete:c?null:function(){!function(){ne(),t.startZoom?(ke("overlay:hidden").css({opacity:0}).show().fadeTo(1e3*m,t.overlayOpacity),oe()):ke("lightboxImage").css({opacity:0}).show().fadeTo(500,1,(function(){oe()}));!function(){var e=l.length-1==o?0:o+1;(new Image).src=l[e].link;var t=0==o?l.length-1:o-1;(new Image).src=l[t].link}()}()}})}(s,r,p,f,k,E,a)}"absolute"!=ke("imageDataContainer").css("position")&&ke("imageDataContainer").css({width:p+"px"}),t.enableRightClick&&(ke("lightboxImage").mousemove(fe),ke("lightboxImage").mouseout(ve))}function ie(e,t,i,n){e.stop(!0,!1);var o={top:i,left:t};n!=e.get(0).style.width&&(o.width=n),e.animate(o,{queue:!1,duration:1e3*u})}function ne(){clearTimeout(n),ke("loading").hide()}function oe(){!function(){if(ke("caption").html((l[o].title||"").replace(/\n/g,"<br>")),l[o].title?ke("caption").show():ke("caption").hide(),l.length>1){var e=t.strings.numDisplayPrefix+" "+parseInt(o+1)+" "+t.strings.numDisplaySeparator+" "+l.length;t.showGroupName&&r&&(e+=" "+t.strings.numDisplaySeparator+" "+r),ke("numberDisplay").text(e),ke("slideShowControl").css({display:g?"":"none"})}}(),t.descSliding?ke("imageDataContainer").animate({height:"show",opacity:"show"},650,null,(function(){ae()})):ae()}function ae(){var e=1/l.length;h=h*(1-e)+ke("imageDataContainer").height()*e,l.length>1?(ke("prevLinkImg").show(),ke("nextLinkImg").show(),g&&(p?re():le())):(ke("prevLinkImg").hide(),ke("nextLinkImg").hide()),document.onkeydown=ge}function re(){ke("lightbox:hidden").length||(de(),p=!0,s=setTimeout((function(){ce()}),1e3*t.slideTime),ke("slideShowControl").text(t.strings.stopSlideshow),ke("slideShowControl").addClass("started"))}function le(){p=!1,de(),ke("slideShowControl").text(t.strings.startSlideshow),ke("slideShowControl").removeClass("started")}function se(){p?le():re()}function de(){s&&(s=clearTimeout(s))}function ce(){if(l.length>1){if(de(),!t.loop&&(o==l.length-1&&0==d||o+1==d))return void pe();o==l.length-1?he(0):he(o+1)}}function he(e){t.descSliding?ke("imageDataContainer").animate({height:"hide",opacity:"hide"},650,null,(function(){ee(e)})):ee(e)}function me(){l.length>1&&he(0==o?l.length-1:o-1)}function ue(){document.onkeydown=""}function ge(e){keycode=null==e?event.keyCode:e.which,key=String.fromCharCode(keycode).toLowerCase(),"x"==key||"o"==key||"c"==key||27==keycode?pe():"p"==key||"%"==key?me():"n"==key||"'"==key?ce():"f"==key?l.length>1&&he(0):"l"==key?l.length>1&&he(l.length-1):"s"==key&&l.length>0&&t.enableSlideshow&&se()}function pe(n){if(n){var o=e(n.target).attr("id");if(Ce("closeLink")!=o&&Ce("lightbox")!=o&&Ce("overlay")!=o)return}ke("imageContainer").stop(!0,!1),ke("lightboxImage").stop(!0,!1),i&&(i.onload=null),ue(),de(),ke("lightbox").hide(),function(){for(var t,i=a,n=0;n<i.length;n++){t=document.getElementsByTagName(i[n]);for(var o=0;o<t.length;o++)e(t[o]).css({visibility:"visible"})}}(),t.overlayOpacity?ke("overlay").fadeOut(1e3*m):ke("overlay").hide(),e(window).unbind("resize",be),e(window).unbind("scroll",be),e(window).unbind("resize",we),e(window).unbind("scroll",we)}function fe(e){e.pageX-ke("imageContainer").offset().left<ke("imageContainer").width()/2?(ke("prevLinkImg").addClass("hover"),ke("nextLinkImg").removeClass("hover")):(ke("prevLinkImg").removeClass("hover"),ke("nextLinkImg").addClass("hover"))}function ve(){ke("prevLinkImg").removeClass("hover"),ke("nextLinkImg").removeClass("hover")}function be(){te(!0)}function we(){ke("overlay").css({left:ye().x+"px",top:0,width:"100%",height:xe()[1]+"px"})}function ye(){var e,t;return self.pageYOffset||self.pageXOffset?(e=self.pageXOffset,t=self.pageYOffset):document.documentElement&&(document.documentElement.scrollTop||document.documentElement.scrollLeft)?(e=document.documentElement.scrollLeft,t=document.documentElement.scrollTop):document.body&&(e=document.body.scrollLeft,t=document.body.scrollTop),{x:e,y:t}}function xe(){var e=document.body,t=document.documentElement,i=0,n=0;return t&&(i=Math.max(i,t.scrollWidth,t.offsetWidth),n=Math.max(n,t.scrollHeight,t.offsetHeight)),e&&(i=Math.max(i,e.scrollWidth,e.offsetWidth),n=Math.max(n,e.scrollHeight,e.offsetHeight),window.innerWidth&&(i=Math.max(i,window.innerWidth),n=Math.max(n,window.innerHeight))),[i,n]}function Ce(e){return t.prefix+e}function ke(t){return e("#"+Ce(t))}}}(jQuery);